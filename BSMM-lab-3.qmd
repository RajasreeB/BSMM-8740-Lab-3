---
title: "BSMM-lab-3"
subtitle: "BSMM 8740 Fall 2023"
author: "Rajasree Bammidi"
date: "2023-10-12"
format: html
editor: visual
self-contained: true
---

## Setup

Load packages and data:

```{r load-pkg-data}
#| message: false
library(magrittr)   # the pipe
library(tidyverse)  # for data wrangling + visualization
library(tidymodels) # for modeling
library(gt)         # for pretty tables
library(dplyr)
library(tidyr)
boston_cocktails <- readr::read_csv('data/boston_cocktails.csv')
```

## Exercises

### Exercise 1

```{r}
boston_cocktails
```

```{r}
summary(boston_cocktails)

median_measure <- median(boston_cocktails$measure_number)
median_measure
```

The median measure amount across across all cocktails is 1 .

### Exercise 2

```{r}

library(dplyr)
library(tidyr)
library(janitor)

selected_data <- boston_cocktails %>%
  select(name, category, ingredient, measure_number)

# Pivot the table and fill missing values with zero
pivoted_data <- selected_data %>%
  pivot_wider(names_from = ingredient, values_from = measure_number, values_fill = 0)

pivoted_data <- pivoted_data %>% clean_names() #Clean column names

cleaned_data <- pivoted_data %>% drop_na()  # Drop rows with NA values

new_dataset <- cleaned_data   # Save the new dataset in a variable

leap_frog_highball <- new_dataset %>%
  filter(name == "Leap Frog Highball")

amount_of_gin <- leap_frog_highball$gin
amount_of_gin
```

The **Leap Frog Highball** contains **2 oz** of gin

### Exercise 3

```{r}
library(recipes)
library(dplyr)

cocktail_recipe <- recipe(~ ., data = boston_cocktails) %>%
  update_role(name, category, new_role = "id") %>%  # Set name and category as 'id' roles
  step_rm(all_predictors(), -all_outcomes()) %>%  # Select only numeric predictors
  step_normalize(all_predictors()) %>%            # Normalize numeric predictors
  step_pca(all_predictors())                       # Perform PCA on numeric predictors

prepped_data <- prep(cocktail_recipe, data = boston_cocktails)

prepped_data <- bake(prepped_data, new_data = NULL)  # Remove the original predictors
```

```{r}
column_names <- colnames(prepped_data)

#number of predictor variables
num_predictor_variables <- length(column_names)
num_predictor_variables
```

**2** predictor variables are prepped by the recipe.

### Exercise 4

```{r}
recipe_info <- recipes::tidy(cocktail_recipe)
```

```{r}
normalization_info <- recipes::tidy(cocktail_recipe, 1)
```

```{r}
ingredient_counts <- boston_cocktails %>%
  group_by(ingredient) %>%
  summarise(avg_measure = mean(measure_number, na.rm = TRUE)) %>%
  arrange(desc(avg_measure))

most_used_ingredient <- ingredient_counts$ingredient[1]
most_used_ingredient
```

On average the most used ingredient in the Boston Cocktails dataset is **cranberry juice.**

### Exercise 5

```{r}

```

Describe describe the drinks represented by PC1?

### Exercise 6

```{r}


```

The characteristic alcoholic beverage of each of the first 4 principle components is \_\_\_.

### Exercise 7

How would you interpret the results of a PCA analysis for a client?
